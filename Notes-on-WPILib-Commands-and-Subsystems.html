<html>
<head>
<style>
code {background-color:#EEE;}
li {margin-bottom: 0.75em;}
</style>
</head>
<body>
<h1>
     Notes on WPILib Commands and Subsystems
</h1>
<p> Based on WPILib 2016</p>
<h2> 
    Command Class
</h2>

<ul>
<li> <b>Command</b> is started with a call to <code>Command.start()</code>
<li> Once started, it will call <code>Command.initialize()</code> once and then <code>Command.execute()</code> repeatedly until <code>Command.isFinished()</code> returns True.
<li> Once it does, <code>Command.end()</code> will be called once to clean up.  
<li> <code>Command.execute()</code> is guaranteed to be called at least once, even if <code>Command.isFinished()</code> always returns true.
<li> If at any point while running, if <code>Command.cancel()</code> is called, then <code>Command.interrupted()</code> will be called.
</ul>

<h3> 
    Requires Subsystem
</h3>

<ul>
<li> If a <b>Command</b> uses a <b>Subsystem</b>, then it should specify that it does so by calling the <code>Command.requires(Subsystem)</code> method in its constructor. 
<li> Note that a <b>Command</b> may have multiple requirements, and <code>Command.requires(Subsystem)</code> should be called for each one.
<li> If a <b>Command</b> is running and a new <b>Command</b> with shared requirements is started, then one of two things will happen. 
   <ul>
   <li> If the active <b>Command</b> is interruptible, then <code>Command.cancel()</code> will be called and the <b>Command</b> will be removed to make way for the new one. 
   <li> If the active <b>Command</b> is not interruptible, the other one will not even be started, and the active one will continue functioning.
   <li> By default, <b>Commands</b> are interruptible.  Call <code>Command.setInterruptible(false)</code> to change this.
   </ul>
</ul>

<h3>
    Timeouts
</h3>

<ul>
<li> A timeout value in seconds can be set by calling the <b>Command</b>'s base class constructor with a parameter of type double.
   <ul>
   <li> Alternately, you can call <code>Command.setTimeout(double)</code>, which is easier to code.
   <li> Timing starts when the <b>Command</b> starts.  
   <li> Use the <code>Command.isTimedOut()</code> boolean in the <code>Command.execute()</code> and <code>Command.isFinished()</code> logic to determine if the <b>Command</b> has timed out.
   </ul>
</ul>

<h3>
    Joystick Buttons
</h3>

<ul>
<li> Joystick <b>Button</b> methods:
   <ul>
   <li> <code>whenPressed() </code>
   <li> <code>whenReleased() </code>
   <li> <code>whileHeld() </code>
   <li> <code>toggleWhenPressed() </code>
   <li> <code>cancelWhenPressed() </code>
   </ul>
<li> <code>Button.whenPressed(Command)</code> will call <code>Command.start()</code> once when the <b>Button</b> is pressed.  The <b>Command</b> will execute until <code>Command.isFinished()</code> returns true or something else calls <code>Command.cancel()</code>
<li> Ditto for <code>Button.whenReleased(Command)</code>
<li> <code>Button.whileHeld(Command)</code> will repeatedly call <code>Command.start()</code> while the <b>Button</b> is pressed.  Once released, it will call <code>Command.Cancel()</code> once.
   <ul>
   <li> This has the effect of calling <code>Command.initialize()</code> then repeatedly calling <code>Command.execute()</code>.  If the <b>Command</b> finishes, it will be restarted again by calling Command.initialize() again and then repeatedly calling <code>Command.execute()</code>, etc.
   </ul>   
<li> <code>Button.toggleWhenPressed(Command)</code>: Each time the <b>Button</b> is pressed:
   <ul>
   <li> if the <b>Command</b> is running, it will call <code>Command.cancel()</code>
   <li> otherwise it calls <code>Command.start()</code>
   </ul>
<li> <code>Button.cancelWhenPressed()</code> calls <code>Command.Cancel()</code> when pressed if the <b>Command</b> is running.  
   <ul>
   <li> The <b>Command</b> must be running for <code>Command.cancel()</code> to be called.  So you cannot cheat by having a <b>Command</b> where only cancel is called.
   </ul>
</ul>
</body>
</html>
